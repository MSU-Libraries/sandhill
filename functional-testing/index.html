
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../service-setup/">
      
      
        <link rel="next" href="../development-guidelines/">
      
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Functional Testing - Sandhill Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a40c8224.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#functional-testing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Sandhill Documentation" class="md-header__button md-logo" aria-label="Sandhill Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sandhill Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Functional Testing
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/MSU-Libraries/sandhill" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    MSU-Libraries/sandhill
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Sandhill Documentation" class="md-nav__button md-logo" aria-label="Sandhill Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Sandhill Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MSU-Libraries/sandhill" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    MSU-Libraries/sandhill
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to Sandhill
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../instance-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instance Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developing-your-instance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developing Your Instance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../service-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Functional Testing
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Functional Testing
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-basics" class="md-nav__link">
    <span class="md-ellipsis">
      The Basics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jinja-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Jinja Processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accessiblity-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Accessiblity Testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accessiblity Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running" class="md-nav__link">
    <span class="md-ellipsis">
      Running
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development-guidelines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development Guidelines
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../routes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Routes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-processors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Processors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Template Filters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bootstrap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bootstrap Process
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../evaluate-conditions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evaluate Conditions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-basics" class="md-nav__link">
    <span class="md-ellipsis">
      The Basics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jinja-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Jinja Processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accessiblity-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Accessiblity Testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accessiblity Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running" class="md-nav__link">
    <span class="md-ellipsis">
      Running
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="functional-testing">Functional Testing</h1>
<p>Sandhill allows you to create automated testing of your site pages, allowing fast
verification that your site is operating normally. Each test can verify any number
of apects of page (or pages) to ensure they are in compliance.</p>
<p>Basically, each test will perform an actual call to your instance of Sandhill and
then perform verification checks on the response. What verification checks it does
is entirely up to you.</p>
<p>Entry of functional tests are maintained in a JSON file at:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>instance/config/testing/pages.json
</code></pre></div></p>
<h2 id="the-basics">The Basics</h2>
<p>Here would be a fairly simple <code>pages.json</code> file with 3 test entries:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>[
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    {
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>        &quot;_comment&quot;: &quot;Ensure main page loads&quot;
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>        &quot;page&quot;: &quot;/&quot;,
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>        &quot;code&quot;: 200,
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>        &quot;contains&quot;: [
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>            &quot;Welcome to my site!&quot;
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>        ]
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    },
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    {
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>        &quot;_comment&quot;: &quot;Access to user profiles should be rejected unless authenticated&quot;
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>        &quot;page&quot;: &quot;/user/1/profile&quot;,
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>        &quot;code&quot;: 401
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    },
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    {
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>        &quot;_comment&quot;: &quot;The order form should be empty by default&quot;,
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>        &quot;page&quot;: &quot;/order/cart&quot;,
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>        &quot;code&quot;: 200,
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>        &quot;contains&quot;: [
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>            &quot;Your cart (0 items)&quot;
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>        ],
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>        &quot;excludes&quot;: [
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>            &quot;Remove from cart&quot;,
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>            &quot;Proceed to checkout&quot;
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>        ]
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>    }
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>]
</code></pre></div></p>
<p>Breaking these tests down:
* <code>_comment</code> Gives you a place to describe the purpose of the test.
* <code>page</code> The relative page on your site to call and test against
* <code>method</code> The method for the call; default <code>GET</code>
* <code>code</code> The HTTP code the request to your page should return.
* <code>contains</code> A list of strings that should exist in the source code returned for the page.
* <code>excludes</code> A list of strings that should NOT exist in the source code returned from the page.
* <code>control</code> A way to defining more advanced testing configurations, such as looping.</p>
<p>For each page entry, all specified tests much succeed or the entire entry will fail.  </p>
<p>To run all your functional tests, issue the command:<br />
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>INSTANCE_DIR=/opt/sandhill/instance /opt/sandhill/env/bin/pytest -m functional --no-cov
</code></pre></div>
Given that:<br />
* <code>/opt/sandhill/instance</code> is where your <code>instance</code> directory is located
* <code>/opt/sandhill</code> is where Sandhill is installed.</p>
<p>Of course, update these to match your setup.  </p>
<p>If all goes well, the output would look like this:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>========================== test session starts =============================
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>platform linux -- Python 3.6.9, pytest-6.0.1, py-1.10.0, pluggy-0.13.1
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>rootdir: /opt/sandhill, configfile: pytest.ini
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>plugins: cov-2.10.0, mock-3.3.1
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>collected 85 items / 82 deselected / 3 selected
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>sandhill/tests/test_pages.py ...                                      [100%]
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>==================== 3 passed, 82 deselected in 32.11s =====================
</code></pre></div></p>
<p>You will see the 3 dots next to the <code>test_pages.py</code> entry along with 3 tests selected
and 3 test passed. The other tests (82 in the example above) are unit tests used by Sandhill
developers to test internal code. It's okay for those to be deselected.  </p>
<p>That's the basics to get started. First create the <code>pages.json</code> file and then start adding
tests to it. Keep reading if you'd like to learn about the more advanced capabilities available.  </p>
<h2 id="advanced-usage">Advanced Usage</h2>
<p>JSON files located in <code>instance/testing/</code> will be loaded for testing. The root object must be a list,
that is, an empty file would appear like:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>[]
</code></pre></div></p>
<p>Adding entries into list must follow a dict type format and may have the following keys:  </p>
<p><strong>_comment</strong> (Optional, String, Jinja Processed)<br />
This is just a freeform string field where you may add a description for the page test.  </p>
<p>Examples:<br />
<code>"_comment": "Check that all embargoed items cannot be downloaded"</code><br />
<code>"_comment": "Verify disclaimer appears on all form pages"</code><br />
<code>"_comment": "Checking asset links for {{ item.asset_id }}"</code>  </p>
<p><strong>page</strong> (String, Jinja Processed)<br />
This is the relative link on which the page test will occur. An actual call to this page
happen as part of the test. If left blank, no page call will occur.  </p>
<p>Examples:<br />
<code>"page": "/node/aboutus"</code>
<code>"page": "/asset/{{ item.asset_id }}/view"</code></p>
<p><strong>method</strong> (String)<br />
The method to use for the test call, such as <code>GET</code>, <code>POST</code>, <code>DELETE</code>, etc.
Case insensitive; defaults to <code>GET</code>.</p>
<p>Examples:<br />
<code>"method": "POST"</code>
<code>"method": "patch"</code></p>
<p><strong>code</strong> (Optional, Integer)<br />
The expected HTTP status code to receive as part of the response for the page call. Ignored
if no <code>page</code> was set.  </p>
<p>Examples:<br />
<code>"code": 200</code>
<code>"code": 403</code></p>
<p><strong>contains</strong> (Optional, List, Jinja Processed)<br />
A list of strings that must exist in the source code returned from the <code>page</code> called. All
entries must exist or the test will fail. Ignored if no <code>page</code> was set.  </p>
<p>Examples:<br />
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>&quot;contains&quot;: [
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    &quot;&lt;a href=\&quot;#required\&quot;&gt;Required Resources&lt;/a&gt;&quot;,
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    &quot;Copyright &amp;copy; MySandhill&quot;
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>]
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>&quot;contains&quot;: [&quot;Request a consultation on {{ record.description }}&quot;]
</code></pre></div></p>
<p><strong>excludes</strong> (Optional, List, Jinja Processed)<br />
A list of strings that must NOT exist in the source code returned from the <code>page</code> called. None
of the entries may exist or else the test will fail. Ignored if no <code>page</code> was set.  </p>
<p>Examples:<br />
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>&quot;excludes&quot;: [
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    &quot;/user/login&quot;,
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    &quot;/asset/{{ item.asset_id }}/download&quot;
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>]
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>&quot;excludes&quot;: [&quot;555-1234&quot;]
</code></pre></div></p>
<p><strong>matches</strong> (Optional, List, Jinja Processed)<br />
A list of strings containing regular expressions that must match in the source code returned from
the <code>page</code> called. All of the entry patterns much match or else the test will fail.
 Ignored if no <code>page</code> was set.  </p>
<p>Examples:<br />
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>&quot;matches&quot;: [
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    &quot;Copyright Status:\\s+In Copyright&quot;,
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    &quot;{{ user.fullname }}\\s+\\d{4}&quot;
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>]
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>&quot;matches&quot;: [&quot;\\d{3}-\\d{4}&quot;]
</code></pre></div></p>
<p><strong>control</strong> (Optional, Dict)<br />
The <code>control</code> part of a test entry defines supplimental JSON data calls to make which can be used
in Jinja procesing, including during <code>evaluate</code> checks.  </p>
<p>An example <code>control</code> section could look like:
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>&quot;control&quot;: {
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    &quot;loop&quot;: &quot;item&quot;,
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    &quot;item&quot;: {
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>        &quot;url&quot;: &quot;{{ &#39;SOLR_URL&#39; | getconfig }}/select?q=status:active&amp;fl=asset_id,title&amp;rows=999999&quot;,
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>        &quot;path&quot;: &quot;$.response.docs[*]&quot;
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    },
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    &quot;child&quot;: {
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>        &quot;url&quot;: &quot;{{ &#39;SOLR_URL&#39; | getconfig }}/select?q=asset_id:{{ item.asset_id }}&amp;fl=asset_id,title&amp;rows=1&quot;,
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>        &quot;path&quot;: &quot;$.response.docs[0]&quot;
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>    }
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>}
</code></pre></div></p>
<p>The only reserved key in a <code>control</code> section is <code>loop</code>. All other keys (<code>item</code>, <code>child</code> in the above example)
are defined with a <code>url</code> and <code>path</code> to perform and parse a JSON call. For this documentation, these other
keys will referred to as the variable <code>VAR</code>.  </p>
<p><strong>control[VAR]</strong> (Optional, Dict, Jinja Processed)<br />
Where <code>VAR</code> is any user defined string, the value must be a dict that defines another JSON API call to
make and parse. Each <code>VAR</code> dict must have both <code>url</code> and <code>path</code> keys defined. There may be any number
of <code>VAR</code> keys, which are processed in the order they are defined (unless a <code>control[loop]</code> is defined, in
which the <code>VAR</code> indicated by the <code>loop</code> is always processed first.  </p>
<p>The results of a <code>control[VAR]</code> call will be stored in the page entry using the <code>VAR</code> key. The response
will be a list of matches, unless the response is indicated by <code>loop</code>, in which the <code>VAR</code> will be a
single entry from the response, but there will be a new page entry for each entry in the response
as well.  </p>
<p>For example, this entry:
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>{
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>    &quot;page&quot;: /asset/{{ item.asset_id }}&quot;,
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>    &quot;code&quot;: 404,
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    &quot;control&quot;: {
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>        &quot;loop&quot;: &quot;item&quot;
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>        &quot;item&quot;: {
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>            &quot;url&quot;: &quot;{{ &#39;SOLR_URL&#39; | getconfig }}/select?q=status:disabled&amp;fl=asset_id,title&amp;rows=999999&quot;,
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>            &quot;path&quot;: &quot;$.response.docs[*]&quot;
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>        }
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>    },
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>    &quot;excludes&quot;: [&quot;{{ item.title }}&quot;]
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>}
</code></pre></div></p>
<p>Could result in a page entry to test for each record in <code>item</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>{
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>    &quot;page&quot;: /asset/1&quot;,
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    &quot;code&quot;: 404,
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    &quot;item&quot;: {&quot;asset_id&quot;: 1, &quot;title&quot;: &quot;My First Widget&quot;},
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>    &quot;excludes&quot;: [&quot;My First Widget&quot;]
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>},
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>{
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>    &quot;page&quot;: /asset/2&quot;,
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>    &quot;code&quot;: 404,
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>    &quot;item&quot;: {&quot;asset_id&quot;: 2, &quot;title&quot;: &quot;My Second Widget&quot;},
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>    &quot;excludes&quot;: [&quot;My Second Widget&quot;]
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>}
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>... (and additional page tests for each record matched by &quot;item&quot; URL and path)
</code></pre></div></p>
<p><strong><code>control[VAR][url]</code></strong> (Optional, String, Jinja Processed)<br />
The <code>url</code> inside a <code>control[VAR]</code> dict defines a valid URL to call. The response must be in JSON format.
The response is then queried by <code>path</code> to get a subset of the JSON.  </p>
<p><strong><code>control[VAR][path]</code></strong> (Optional, String, Jinja Processed)<br />
A JSONPath query to parse the JSON response from <code>url</code> to select a subset of data. The results of this
JSONPath query will be set into the page test entry under the key <code>VAR</code>.  </p>
<p><strong><code>control[loop]</code></strong> (Optional, String)<br />
The <code>loop</code> key in <code>control</code> must have a value that indicates another <code>VAR</code> key in <code>control</code> which must also be
defined. The response from this targeted <code>VAR</code> will be looped over, generating a new page test entry
for each item in the target <code>VAR</code>.  </p>
<p><strong><code>evaluate</code></strong> (Optional, List, Jinja Required)<br />
A list of strings that will be rendered by Jinja and then evaluated for truthiness. If the strings in
the list are not wrapped by Jinja delimiters, the <code>{{</code> and <code>}}</code> delimiters will automatically be wrapped
around the value. All entries must evaluate to a truthy value after having be Jinja processed or
the test will fail. You must have set a <code>control</code> section in order to have data to evaluate on.  </p>
<p>Values in an evaluate string are first parsed for JSONPath queries. Queries must begin with a
root indictor <code>$</code>. If no context key is provided, it will query against the first data key available.
To specify a JSONPath query to operate on a specific key, add the key name directly after
the <code>$</code>, such as <code>$item.myquery</code>.  </p>
<p>Examples:<br />
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>&quot;evaluate&quot;: [
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>    &quot;item.namespace == child[0].namespace&quot;,
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>    &quot;child[0].collection in item.collections&quot;
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>    &quot;$item.response.numFound == $item.facet_counts.facet_fields.collection[1]&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>&quot;evaluate&quot;: [&quot;{{ page | lower == page }}&quot;]
</code></pre></div></p>
<h2 id="jinja-processing">Jinja Processing</h2>
<p>Any field that is Jinja processed has access to all filters and context processors from Sandhill.
The context variables will be the entire page entry processed thus far.  </p>
<p>Jinja processing occurs in steps, with each step having access to the data already processed in
previous steps. Processing order is:
* The <code>control[VAR]</code> indicated by <code>control[loop]</code>.
* Each remaining <code>control[VAR]</code> in order of definition.
* The entire page entry, minus the <code>evaluate</code> key.
* The <code>evaluate</code> key (which occurs only during actual testing).</p>
<h2 id="advanced-examples">Advanced Examples</h2>
<p>TODO</p>
<h2 id="accessiblity-testing">Accessiblity Testing</h2>
<p>If you want to automcatically scan certain pages for accessibility violations, you
can include those as part of your functional testing configuration.</p>
<h3 id="running">Running</h3>
<p>Tests can be run by using the helper script included with this repository <code>run-pytest</code>
with the <code>-a</code> flag for accessibility.
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>./run-pytest -a
</code></pre></div></p>
<h3 id="configuration">Configuration</h3>
<p>Below is a sample entry for functional testing as seen earlier in this document.
Notice now the added key for <code>a11y</code>. Additionally, you can provide an optional <code>disable</code>
key which will ignore the provided list of Axe rules from the scan on that page.</p>
<p>For a complete list of available rules to exclude see the <a href="https://dequeuniversity.com/rules/axe/4.3">official site</a>.
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>    {
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>        &quot;_comment&quot;: &quot;Ensure main page loads&quot;
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>        &quot;page&quot;: &quot;/&quot;,
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>        &quot;code&quot;: 200,
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>        &quot;contains&quot;: [
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>            &quot;Welcome to my site!&quot;
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>        ],
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>        &quot;axe&quot;: {}
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    },
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>    {
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>        &quot;_comment&quot;: &quot;Ensure second page loads&quot;
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>        &quot;page&quot;: &quot;/page 2&quot;,
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>        &quot;code&quot;: 200,
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>        &quot;contains&quot;: [
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>            &quot;Welcome to my page!&quot;
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>        ],
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>        &quot;axe&quot;: {
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>            &quot;disable&quot;: [&quot;landmark-main-is-top-level&quot;, &quot;landmark-one-main&quot;]
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>        }
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>    }
</code></pre></div></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "navigation.instant"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>