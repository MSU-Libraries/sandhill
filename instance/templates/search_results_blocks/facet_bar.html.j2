<h2>Facets</h2>
{% for facet_field in search_conf["facet_fields"] %}
    <h3>{{ facet_field["label"] }}</h3>
    <ul class="sh-facet-term overflow-auto list-unstyled" style="max-height: 20rem">
    {% set facet_field_values = search["facet_counts"]["facet_fields"][facet_field["field"]] | maketuplelist(2) %}
    {% for value, count in facet_field_values %}
        <li>
            {% set cur_url = url_components | deepcopy %}
            {% set _ = cur_url['query_args'] | addfilterquery(facet_field['field'], value) %}
            <a href="{{ cur_url | assemble_url }}">{{ value }}</a>
            <span class="badge badge-dark">{{ count }}</span>
            {% if url_components['query_args'] | hasfilterquery(facet_field['field'], value) %}
                {% set _ = cur_url['query_args'] | removefilterquery(facet_field['field'], value) %}
                <a href="{{ cur_url | assemble_url }}">X</a>
            {% endif %}
        </li>
    {% endfor %}
    </ul>
{% endfor %}
